import{d as T,c as v,b as s,p as Z,e as X,a as d,o as u,g as j,u as D,r as A,z as O,j as a,i as R,w as c,F as S,S as F,v as x,f as w,t as N,V as W,k as p,m as z,A as J,D as ee,B as U,W as G,X as K,h as $,Y as H,Z as oe,$ as Q,s as y,a0 as ie,a1 as ne,a2 as re,Q as ce,x as te,y as L,a3 as ue,a4 as E,a5 as de,a6 as me,G as _e,U as fe,a7 as be,N as pe,a8 as ke,a9 as ve,aa as ge}from"./index-8c4b8b6b.js";import{T as ye,C as he,P as Re}from"./TradesLog-ce01201a.js";import{_ as xe,P as Be}from"./PairSummary-cbeab127.js";import{a as ae,_ as we,b as $e,P as Ve}from"./InfoBox.vue_vue_type_script_setup_true_lang-cf02f3fe.js";import{T as se}from"./TradeList-8d080513.js";import{_ as Ce}from"./chevron-down-a5459827.js";import{C as Ae}from"./CandleChartContainer-38d35f60.js";import{_ as Se,a as Y,b as Te}from"./StrategySelect.vue_vue_type_script_setup_true_lang-648c9838.js";import"./installCanvasRenderer-3ce2e16e.js";import"./chartZoom-888b3aed.js";import"./createSeriesDataSimply-71a90986.js";import"./EditValue.vue_vue_type_script_setup_true_lang-838d2c31.js";import"./plus-box-outline-973bbcdb.js";const qe=i=>(Z("data-v-159fa462"),i=i(),X(),i),Ue={class:"text-center flex-fill mt-2 d-flex flex-column"},Pe=qe(()=>d("hr",null,null,-1)),Ie=T({__name:"BacktestGraphs",props:{trades:{required:!0,type:Array}},setup(i){return(e,t)=>(u(),v("div",Ue,[s(ye,{trades:i.trades,class:"trades-log"},null,8,["trades"]),s(he,{trades:i.trades,class:"cum-profit","show-title":!0},null,8,["trades"]),Pe,s(Re,{class:"mt-3",trades:i.trades,"show-title":!0},null,8,["trades"])]))}});const Me=j(Ie,[["__scopeId","data-v-159fa462"]]),De=d("p",null," Load Historic results from disk. You can click on multiple results to load all of them into freqUI. ",-1),Ne=T({__name:"BacktestHistoryLoad",setup(i){const e=D(),t=A();O(()=>{e.activeBot.getBacktestHistory()});function b(m){var o;const l={title:"Stop Bot",message:`Delete result ${m.filename} from disk?`,accept:()=>{e.activeBot.deleteBacktestHistoryResult(m)}};(o=t.value)==null||o.show(l)}return(m,l)=>{const o=J,f=ee,k=U,h=G,_=K;return u(),v(S,null,[d("div",null,[d("button",{class:"btn btn-secondary float-end",title:"Refresh","aria-label":"Refresh",onClick:l[0]||(l[0]=(...n)=>a(e).activeBot.getBacktestHistory&&a(e).activeBot.getBacktestHistory(...n))},[s(o)]),De,a(e).activeBot.backtestHistoryList?(u(),R(_,{key:0,class:"ms-2 mb-1"},{default:c(()=>[(u(!0),v(S,null,F(a(e).activeBot.backtestHistoryList,(n,q)=>(u(),R(h,{key:q,class:"d-flex justify-content-between align-items-center py-1 pe-2",button:"",disabled:n.run_id in a(e).activeBot.backtestHistory,onClick:r=>a(e).activeBot.getBacktestHistoryResult(n)},{default:c(()=>[d("strong",null,x(n.strategy),1),w(" backtested on: "+x(a(N)(n.backtest_start_time*1e3))+" ",1),d("small",null,x(n.filename),1),a(e).activeBot.botApiVersion>=2.32?(u(),R(ae,{key:0,class:W(n.notes?"opacity-100":"opacity-0"),hint:n.notes??""},null,8,["class","hint"])):p("",!0),a(e).activeBot.botApiVersion>=2.31?(u(),R(k,{key:1,class:"ms-1",size:"sm",title:"Delete this Result.",disabled:n.run_id in a(e).activeBot.backtestHistory,onClick:z(r=>b(n),["stop"])},{default:c(()=>[s(f)]),_:2},1032,["disabled","onClick"])):p("",!0)]),_:2},1032,["disabled","onClick"]))),128))]),_:1})):p("",!0)]),s(xe,{ref_key:"msgBox",ref:t},null,512)],64)}}}),Le={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},ze=d("path",{fill:"currentColor",d:"M8.59 16.58L13.17 12L8.59 7.41L10 6l6 6l-6 6l-1.41-1.42Z"},null,-1),Fe=[ze];function je(i,e){return u(),v("svg",Le,Fe)}const Ee={name:"mdi-chevron-right",render:je},He={class:"d-flex"},Oe={class:"d-flex flex-column"},We={key:0},Ge={class:"px-3 m-0"},Ke=T({__name:"TradeListNav",props:{trades:{required:!0,type:Array},backtestMode:{required:!1,default:!1,type:Boolean}},emits:["trade-select"],setup(i,{emit:e}){const t=i,b=D(),m=A({}),l=A(!0),o=h=>{m.value=h,e("trade-select",h)},f=$(()=>t.trades.slice().sort((h,_)=>l.value?_.open_timestamp-h.open_timestamp:h.open_timestamp-_.open_timestamp)),k=A(f.value.map(()=>!1));return H(()=>b.activeBot.selectedPair,()=>{k.value=f.value.map(()=>!1)}),(h,_)=>{const n=G,q=Ee,r=Ce,g=U,B=oe,V=K;return u(),v("div",null,[s(V,null,{default:c(()=>[s(n,{button:"",class:"d-flex flex-wrap justify-content-center align-items-center",title:"Trade Navigation",onClick:_[0]||(_[0]=C=>l.value=!l.value)},{default:c(()=>[w("Trade Navigation "+x(l.value?"↓":"↑"),1)]),_:1}),(u(!0),v(S,null,F(f.value,(C,P)=>(u(),R(n,{key:C.open_timestamp,button:"",class:"d-flex flex-column py-1 pe-1 align-items-stretch",title:`${C.pair}`,active:C.open_timestamp===m.value.open_timestamp,onClick:I=>o(C)},{default:c(()=>[d("div",He,[d("div",Oe,[d("div",null,[a(b).activeBot.botState.trading_mode!=="spot"?(u(),v("span",We,x(C.is_short?"S-":"L-"),1)):p("",!0),s(we,{date:C.open_timestamp},null,8,["date"])]),s($e,{trade:C,class:"my-1"},null,8,["trade"]),i.backtestMode?(u(),R(Ve,{key:0,"profit-ratio":C.profit_ratio,"stake-currency":a(b).activeBot.stakeCurrency},null,8,["profit-ratio","stake-currency"])):p("",!0)]),s(g,{size:"sm",class:"ms-auto",variant:"outline-secondary",onClick:I=>k.value[P]=!k.value[P]},{default:c(()=>[k.value[P]?p("",!0):(u(),R(q,{key:0,width:"24",height:"24"})),k.value[P]?(u(),R(r,{key:1,width:"24",height:"24"})):p("",!0)]),_:2},1032,["onClick"])]),s(B,{modelValue:k.value[P],"onUpdate:modelValue":I=>k.value[P]=I},{default:c(()=>{var I;return[d("ul",Ge,[(u(!0),v(S,null,F((I=C.orders)==null?void 0:I.filter(M=>M.order_filled_timestamp!==null),M=>(u(),v("li",{key:M.order_timestamp},x(M.ft_order_side)+" "+x(M.amount)+" at "+x(M.safe_price),1))),128))])]}),_:2},1032,["modelValue","onUpdate:modelValue"])]),_:2},1032,["title","active","onClick"]))),128)),i.trades.length===0?(u(),R(n,{key:0},{default:c(()=>[w("No trades to show...")]),_:1})):p("",!0)]),_:1})])}}});const Qe=j(Ke,[["__scopeId","data-v-d1f90825"]]),Ye={class:"row"},Ze={class:"col-md-11 text-start"},Xe={class:"col-md-1 text-end"},Je={class:"row text-center h-100 d-flex align-items-stretch"},et=T({__name:"BacktestResultChart",props:{timeframe:{required:!0,type:String},strategy:{required:!0,type:String},freqaiModel:{required:!1,default:void 0,type:String},timerange:{required:!0,type:String},pairlist:{required:!0,type:Array},trades:{required:!0,type:Array}},setup(i){const e=D(),t=A(!0),b=A(),m=l=>{b.value={startValue:l.open_timestamp,endValue:l.close_timestamp}};return(l,o)=>{const f=U,k=Q;return u(),v("div",null,[d("div",Ye,[d("div",Ze,[d("p",null," Graph will always show the latest values for the selected strategy. Timerange: "+x(i.timerange)+" - "+x(i.strategy),1)]),d("div",Xe,[s(f,{"aria-label":"Close",title:"Trade Navigation",size:"sm",onClick:o[0]||(o[0]=h=>t.value=!t.value)},{default:c(()=>[w(x(t.value?">":"<"),1)]),_:1})])]),d("div",Je,[s(Be,{class:"col-md-2 overflow-auto",style:{"max-height":"calc(100vh - 200px)"},pairlist:i.pairlist,trades:i.trades,"sort-method":"profit","backtest-mode":!0},null,8,["pairlist","trades"]),s(Ae,{"available-pairs":i.pairlist,"historic-view":!0,timeframe:i.timeframe,timerange:i.timerange,strategy:i.strategy,trades:i.trades,class:W(`${t.value?"col-md-8":"col-md-10"} candle-chart-container px-0 h-100 align-self-stretch`),"slider-position":b.value,"freqai-model":i.freqaiModel},null,8,["available-pairs","timeframe","timerange","strategy","trades","class","slider-position","freqai-model"]),t.value?(u(),R(Qe,{key:0,class:"overflow-auto col-md-2",style:{"max-height":"calc(100vh - 200px)"},trades:i.trades.filter(h=>h.pair===a(e).activeBot.selectedPair),onTradeSelect:m},null,8,["trades"])):p("",!0)]),s(k,{header:"Single trades",class:"row mt-2 w-100"},{default:c(()=>[s(se,{class:"row trade-history mt-2 w-100",trades:i.trades,"show-filter":!0},null,8,["trades"])]),_:1})])}}});const tt=j(et,[["__scopeId","data-v-1fe46937"]]),at={class:"container d-flex flex-column align-items-stretch"},st=d("h3",null,"Available results:",-1),lt={class:"d-flex flex-column me-2 text-start"},ot={class:"fw-bold"},it={class:"text-small"},nt={key:0,class:"text-small",style:{"white-space":"pre-wrap"}},rt={class:"d-flex"},ct=T({__name:"BacktestResultSelect",props:{backtestHistory:{required:!0,type:Object},selectedBacktestResultKey:{required:!1,default:"",type:String},canUseModify:{required:!1,default:!1,type:Boolean}},emits:["selectionChange","removeResult","updateResult"],setup(i,{emit:e}){const t=m=>{e("selectionChange",m)};function b(m,l){l.metadata.editing=!l.metadata.editing,l.metadata.filename&&e("updateResult",{run_id:m,notes:l.metadata.notes??"",filename:l.metadata.filename,strategy:l.metadata.strategyName})}return(m,l)=>{const o=ie,f=U,k=ee,h=ne,_=re,n=G,q=K;return u(),v("div",at,[st,s(q,{class:"ms-2"},{default:c(()=>[(u(!0),v(S,null,F(Object.entries(i.backtestHistory),([r,g])=>(u(),R(n,{key:r,button:"",active:r===i.selectedBacktestResultKey,class:"d-flex justify-content-between align-items-center py-1 pe-1",onClick:B=>t(r)},{default:c(()=>[g.metadata.editing?p("",!0):(u(),v(S,{key:0},[d("div",lt,[d("div",ot,x(g.metadata.strategyName)+" - "+x(g.strategy.timeframe),1),d("div",it," TradeCount: "+x(g.strategy.total_trades)+" - Profit: "+x(a(y)(g.strategy.profit_total)),1),i.canUseModify?(u(),v("div",nt,x(g.metadata.notes),1)):p("",!0)]),d("div",rt,[i.canUseModify?(u(),R(f,{key:0,class:"flex-nowrap",size:"sm",title:"Modify",onClick:z(B=>g.metadata.editing=!g.metadata.editing,["stop"])},{default:c(()=>[s(o)]),_:2},1032,["onClick"])):p("",!0),s(f,{size:"sm",class:"flex-nowrap",title:"Delete this Result.",onClick:z(B=>e("removeResult",r),["stop"])},{default:c(()=>[s(k)]),_:2},1032,["onClick"])])],64)),g.metadata.editing?(u(),v(S,{key:1},[s(h,{modelValue:g.metadata.notes,"onUpdate:modelValue":B=>g.metadata.notes=B,placeholder:"notes",size:"sm"},null,8,["modelValue","onUpdate:modelValue"]),s(f,{size:"sm",title:"Confirm",onClick:z(B=>b(r,g),["stop"])},{default:c(()=>[s(_)]),_:2},1032,["onClick"])],64)):p("",!0)]),_:2},1032,["active","onClick"]))),128))]),_:1})])}}}),ut=T({__name:"BacktestResultPeriodBreakdown",props:{periodicBreakdown:{type:Object,required:!0}},setup(i){const e=[{value:"day",text:"Days"},{value:"week",text:"Weeks"},{value:"month",text:"Months"}],t=A("month"),b=$(()=>[{key:"date",label:"Date"},{key:"wins",label:"Wins"},{key:"draws",label:"Draws"},{key:"loses",label:"Losses"}]);return(m,l)=>{const o=ce,f=te;return u(),v(S,null,[s(o,{id:"order-direction",modelValue:t.value,"onUpdate:modelValue":l[0]||(l[0]=k=>t.value=k),options:e,name:"radios-btn-default",size:"sm",buttons:"",style:{"min-width":"10em"},"button-variant":"outline-primary"},null,8,["modelValue"]),s(f,{small:"",hover:"",stacked:"sm",items:i.periodicBreakdown[t.value],fields:b.value},null,8,["items","fields"])],64)}}}),dt={class:"px-0 mw-100"},mt={class:"d-flex justify-content-center"},_t={class:"d-flex flex-column text-start ms-0 me-2 gap-2"},ft={class:"d-flex flex-column flex-xl-row"},bt={class:"px-0 px-xl-0 pe-xl-1 flex-fill"},pt={class:"px-0 px-xl-0 pt-2 pt-xl-0 ps-xl-1 flex-fill"},kt=T({__name:"BacktestResultAnalysis",props:{backtestResult:{required:!0,type:Object}},setup(i){const e=i,t=r=>`${L(r,e.backtestResult.stake_currency_decimals)} ${e.backtestResult.stake_currency}`,b=r=>r.trades.slice().sort((B,V)=>B.profit_ratio-V.profit_ratio),m=$(()=>{const r=b(e.backtestResult);if(r.length===0)return"N/A";const g=r[r.length-1];return`${g.pair} ${y(g.profit_ratio,2)}`}),l=$(()=>{const r=b(e.backtestResult);if(r.length===0)return"N/A";const g=r[0];return`${g.pair} ${y(g.profit_ratio,2)}`}),o=$(()=>e.backtestResult.results_per_pair[e.backtestResult.results_per_pair.length-1]),f=$(()=>{var g,B;const r=(g=e.backtestResult)!=null&&g.trade_count_short&&((B=e.backtestResult)==null?void 0:B.trade_count_short)>0?[{metric:"___",value:"___"},{metric:"Long / Short",value:`${e.backtestResult.trade_count_long} / ${e.backtestResult.trade_count_short}`},{metric:"Total profit Long",value:`${y(e.backtestResult.profit_total_long||0)} | ${t(e.backtestResult.profit_total_long_abs)}`},{metric:"Total profit Short",value:`${y(e.backtestResult.profit_total_short||0)} | ${t(e.backtestResult.profit_total_short_abs)}`}]:[];return[{metric:"Total Profit",value:`${y(e.backtestResult.profit_total)} | ${t(e.backtestResult.profit_total_abs)}`},{metric:"CAGR",value:`${e.backtestResult.cagr?y(e.backtestResult.cagr):"N/A"}`},{metric:"Sortino",value:`${e.backtestResult.sortino?e.backtestResult.sortino.toFixed(2):"N/A"}`},{metric:"Sharpe",value:`${e.backtestResult.sharpe?e.backtestResult.sharpe.toFixed(2):"N/A"}`},{metric:"Calmar",value:`${e.backtestResult.calmar?e.backtestResult.calmar.toFixed(2):"N/A"}`},{metric:`Expectancy ${e.backtestResult.expectancy_ratio?"(ratio)":""}`,value:`${e.backtestResult.expectancy?e.backtestResult.expectancy_ratio?e.backtestResult.expectancy.toFixed(2)+" ("+e.backtestResult.expectancy_ratio.toFixed(2)+")":e.backtestResult.expectancy.toFixed(2):"N/A"}`},{metric:"Profit factor",value:`${e.backtestResult.profit_factor?L(e.backtestResult.profit_factor,3):"N/A"}`},{metric:"Total trades / Daily Avg Trades",value:`${e.backtestResult.total_trades} / ${e.backtestResult.trades_per_day}`},{metric:"Best day",value:`${y(e.backtestResult.backtest_best_day,2)} | ${t(e.backtestResult.backtest_best_day_abs)}`},{metric:"Worst day",value:`${y(e.backtestResult.backtest_worst_day,2)} | ${t(e.backtestResult.backtest_worst_day_abs)}`},{metric:"Win/Draw/Loss",value:`${o.value.wins} / ${o.value.draws} / ${o.value.losses} ${ue(o.value.winrate)?"(WR: "+y(e.backtestResult.results_per_pair[e.backtestResult.results_per_pair.length-1].winrate??0,2)+")":""}`},{metric:"Days win/draw/loss",value:`${e.backtestResult.winning_days} / ${e.backtestResult.draw_days} / ${e.backtestResult.losing_days}`},{metric:"Avg. Duration winners",value:E(e.backtestResult.winner_holding_avg_s)},{metric:"Avg. Duration Losers",value:E(e.backtestResult.loser_holding_avg_s)},{metric:"Max Consecutive Wins / Loss",value:e.backtestResult.max_consecutive_wins===void 0?"N/A":`${e.backtestResult.max_consecutive_wins} / ${e.backtestResult.max_consecutive_losses}`},{metric:"Rejected entry signals",value:e.backtestResult.rejected_signals},{metric:"Entry/Exit timeouts",value:`${e.backtestResult.timedout_entry_orders} / ${e.backtestResult.timedout_exit_orders}`},{metric:"Canceled Trade Entries",value:e.backtestResult.canceled_trade_entries??"N/A"},{metric:"Canceled Entry Orders",value:e.backtestResult.canceled_entry_orders??"N/A"},{metric:"Replaced Entry Orders",value:e.backtestResult.replaced_entry_orders??"N/A"},...r,{metric:"___",value:"___"},{metric:"Min balance",value:t(e.backtestResult.csum_min)},{metric:"Max balance",value:t(e.backtestResult.csum_max)},{metric:"Market change",value:y(e.backtestResult.market_change)},{metric:"___",value:"___"},{metric:"Max Drawdown (Account)",value:y(e.backtestResult.max_drawdown_account)},{metric:"Max Drawdown ABS",value:t(e.backtestResult.max_drawdown_abs)},{metric:"Drawdown high | low",value:`${t(e.backtestResult.max_drawdown_high)} | ${t(e.backtestResult.max_drawdown_low)}`},{metric:"Drawdown start",value:N(e.backtestResult.drawdown_start_ts)},{metric:"Drawdown end",value:N(e.backtestResult.drawdown_end_ts)},{metric:"___",value:"___"},{metric:"Best Pair",value:`${e.backtestResult.best_pair.key} ${y(e.backtestResult.best_pair.profit_sum)}`},{metric:"Worst Pair",value:`${e.backtestResult.worst_pair.key} ${y(e.backtestResult.worst_pair.profit_sum)}`},{metric:"Best single Trade",value:m.value},{metric:"Worst single Trade",value:l.value}]}),k=$(()=>[{setting:"Backtesting from",value:N(e.backtestResult.backtest_start_ts)},{setting:"Backtesting to",value:N(e.backtestResult.backtest_end_ts)},{setting:"BT execution time",value:E(e.backtestResult.backtest_run_end_ts-e.backtestResult.backtest_run_start_ts)},{setting:"Max open trades",value:e.backtestResult.max_open_trades},{setting:"Timeframe",value:e.backtestResult.timeframe},{setting:"Timeframe Detail",value:e.backtestResult.timeframe_detail||"N/A"},{setting:"Timerange",value:e.backtestResult.timerange},{setting:"Stoploss",value:y(e.backtestResult.stoploss,2)},{setting:"Trailing Stoploss",value:e.backtestResult.trailing_stop},{setting:"Trail only when offset is reached",value:e.backtestResult.trailing_only_offset_is_reached},{setting:"Trailing Stop positive",value:e.backtestResult.trailing_stop_positive},{setting:"Trailing stop positive offset",value:e.backtestResult.trailing_stop_positive_offset},{setting:"Custom Stoploss",value:e.backtestResult.use_custom_stoploss},{setting:"ROI",value:e.backtestResult.minimal_roi},{setting:"Use Exit Signal",value:e.backtestResult.use_exit_signal!==void 0?e.backtestResult.use_exit_signal:e.backtestResult.use_sell_signal},{setting:"Exit profit only",value:e.backtestResult.exit_profit_only!==void 0?e.backtestResult.exit_profit_only:e.backtestResult.sell_profit_only},{setting:"Exit profit offset",value:e.backtestResult.exit_profit_offset!==void 0?e.backtestResult.exit_profit_offset:e.backtestResult.sell_profit_offset},{setting:"Enable protections",value:e.backtestResult.enable_protections},{setting:"Starting balance",value:t(e.backtestResult.starting_balance)},{setting:"Final balance",value:t(e.backtestResult.final_balance)},{setting:"Avg. stake amount",value:t(e.backtestResult.avg_stake_amount)},{setting:"Total trade volume",value:t(e.backtestResult.total_volume)}]),h=$(()=>[{key:"key",label:"Pair"},{key:"trades",label:"Buys"},{key:"profit_mean",label:"Avg Profit %",formatter:r=>y(r,2)},{key:"profit_sum",label:"Cum Profit %",formatter:r=>y(r,2)},{key:"profit_total_abs",label:`Tot Profit ${e.backtestResult.stake_currency}`,formatter:r=>L(r,e.backtestResult.stake_currency_decimals)},{key:"profit_total",label:"Tot Profit %",formatter:r=>y(r,2)},{key:"duration_avg",label:"Avg Duration"},{key:"wins",label:"Wins"},{key:"draws",label:"Draws"},{key:"losses",label:"Losses"}]),_=$(()=>[{key:"exit_reason",label:"Exit Reason"},{key:"trades",label:"Buys"},{key:"profit_mean",label:"Avg Profit %",formatter:r=>y(r,2)},{key:"profit_sum",label:"Cum Profit %",formatter:r=>y(r,2)},{key:"profit_total_abs",label:`Tot Profit ${e.backtestResult.stake_currency}`,formatter:r=>L(r,e.backtestResult.stake_currency_decimals)},{key:"profit_total",label:"Tot Profit %",formatter:r=>y(r,2)},{key:"wins",label:"Wins"},{key:"draws",label:"Draws"},{key:"losses",label:"Losses"}]),n=[{key:"metric",label:"Metric"},{key:"value",label:"Value"}],q=[{key:"setting",label:"Setting"},{key:"value",label:"Value"}];return(r,g)=>{const B=te,V=Q;return u(),v("div",dt,[d("div",mt,[d("h3",null,"Backtest-result for "+x(i.backtestResult.strategy_name),1)]),d("div",_t,[d("div",ft,[d("div",bt,[s(V,{header:"Strategy settings"},{default:c(()=>[s(B,{small:"",borderless:"",items:k.value,fields:q},null,8,["items"])]),_:1})]),d("div",pt,[s(V,{header:"Metrics"},{default:c(()=>[s(B,{small:"",borderless:"",items:f.value,fields:n},null,8,["items"])]),_:1})])]),s(V,{header:"Results per Exit-reason"},{default:c(()=>[s(B,{small:"",hover:"",stacked:"sm",items:i.backtestResult.exit_reason_summary||i.backtestResult.sell_reason_summary,fields:_.value},null,8,["items","fields"])]),_:1}),s(V,{header:"Results per pair"},{default:c(()=>[s(B,{small:"",hover:"",stacked:"sm",items:i.backtestResult.results_per_pair,fields:h.value},null,8,["items","fields"])]),_:1}),i.backtestResult.periodic_breakdown?(u(),R(V,{key:0,header:"Periodic breakdown"},{default:c(()=>[s(ut,{"periodic-breakdown":i.backtestResult.periodic_breakdown},null,8,["periodic-breakdown"])]),_:1})):p("",!0),s(V,{header:"Single trades"},{default:c(()=>[s(se,{trades:i.backtestResult.trades,"show-filter":!0,"stake-currency":i.backtestResult.stake_currency},null,8,["trades","stake-currency"])]),_:1})])])}}}),vt={class:"w-100 d-flex"},gt={class:"ms-2"},yt=T({__name:"FreqaiModelSelect",props:{modelValue:{type:String,required:!0}},emits:["update:modelValue"],setup(i,{emit:e}){const t=i,b=D(),m=$({get(){return t.modelValue},set(l){e("update:modelValue",l)}});return O(()=>{b.activeBot.freqaiModelList.length===0&&b.activeBot.getFreqAIModelList()}),(l,o)=>{const f=de,k=J,h=U;return u(),v("div",null,[d("div",vt,[s(f,{id:"freqaiModel-select",modelValue:m.value,"onUpdate:modelValue":o[0]||(o[0]=_=>m.value=_),options:a(b).activeBot.freqaiModelList},null,8,["modelValue","options"]),d("div",gt,[s(h,{onClick:a(b).activeBot.getFreqAIModelList},{default:c(()=>[s(k)]),_:1},8,["onClick"])])])])}}}),le=me("btStore",{state:()=>({strategy:"",selectedTimeframe:"",selectedDetailTimeframe:"",timerange:"",maxOpenTrades:"",stakeAmount:"",startingCapital:"",allowCache:!0,enableProtections:!1,stakeAmountUnlimited:!1,freqAI:{enabled:!1,model:"",identifier:""}}),getters:{},actions:{}}),ht={class:"mb-2"},Rt=d("span",null,"Strategy",-1),xt={class:"d-flex"},Bt={class:"d-flex justify-content-center"},wt=d("span",{class:"me-2"},"Enable FreqAI:",-1),$t=d("hr",null,null,-1),Vt=d("h3",{class:"mt-3"},"Backtesting summary",-1),Ct={class:"d-flex flex-wrap flex-md-nowrap justify-content-between justify-content-md-center"},At=T({__name:"BacktestRun",setup(i){const e=D(),t=le();function b(){const m={strategy:t.strategy,timerange:t.timerange,enable_protections:t.enableProtections},l=parseInt(t.maxOpenTrades,10);if(l&&(m.max_open_trades=l),t.stakeAmountUnlimited)m.stake_amount="unlimited";else{const f=Number(t.stakeAmount);f&&(m.stake_amount=f.toString())}const o=Number(t.startingCapital);o&&(m.dry_run_wallet=o),t.selectedTimeframe&&(m.timeframe=t.selectedTimeframe),t.selectedDetailTimeframe&&(m.timeframe_detail=t.selectedDetailTimeframe),t.allowCache||(m.backtest_cache="none"),t.freqAI.enabled&&(m.freqaimodel=t.freqAI.model,t.freqAI.identifier!==""&&(m.freqai={identifier:t.freqAI.identifier})),e.activeBot.startBacktest(m)}return(m,l)=>{const o=_e,f=fe,k=be,h=Q,_=U;return u(),v(S,null,[d("div",ht,[Rt,s(Se,{modelValue:a(t).strategy,"onUpdate:modelValue":l[0]||(l[0]=n=>a(t).strategy=n)},null,8,["modelValue"])]),s(h,{disabled:a(e).activeBot.backtestRunning},{default:c(()=>[s(o,{"label-cols-lg":"2",label:"Backtest params","label-size":"sm","label-class":"fw-bold pt-0",class:"mb-0"},{default:c(()=>[s(o,{"label-cols-sm":"5",label:"Timeframe:","label-align-sm":"right","label-for":"timeframe-select"},{default:c(()=>[s(Y,{id:"timeframe-select",modelValue:a(t).selectedTimeframe,"onUpdate:modelValue":l[1]||(l[1]=n=>a(t).selectedTimeframe=n)},null,8,["modelValue"])]),_:1}),s(o,{"label-cols-sm":"5",label:"Detail Timeframe:","label-align-sm":"right","label-for":"timeframe-detail-select",title:"Detail timeframe, to simulate intra-candle results. Not setting this will not use this functionality."},{default:c(()=>[s(Y,{id:"timeframe-detail-select",modelValue:a(t).selectedDetailTimeframe,"onUpdate:modelValue":l[2]||(l[2]=n=>a(t).selectedDetailTimeframe=n),"below-timeframe":a(t).selectedTimeframe},null,8,["modelValue","below-timeframe"])]),_:1}),s(o,{"label-cols-sm":"5",label:"Max open trades:","label-align-sm":"right","label-for":"max-open-trades"},{default:c(()=>[s(f,{id:"max-open-trades",modelValue:a(t).maxOpenTrades,"onUpdate:modelValue":l[3]||(l[3]=n=>a(t).maxOpenTrades=n),placeholder:"Use strategy default",type:"number"},null,8,["modelValue"])]),_:1}),s(o,{"label-cols-sm":"5",label:"Starting capital:","label-align-sm":"right","label-for":"starting-capital"},{default:c(()=>[s(f,{id:"starting-capital",modelValue:a(t).startingCapital,"onUpdate:modelValue":l[4]||(l[4]=n=>a(t).startingCapital=n),type:"number",step:"0.001"},null,8,["modelValue"])]),_:1}),s(o,{"label-cols-sm":"5",label:"Stake amount:","label-align-sm":"right","label-for":"stake-amount"},{default:c(()=>[d("div",xt,[s(k,{id:"stake-amount-bool",modelValue:a(t).stakeAmountUnlimited,"onUpdate:modelValue":l[5]||(l[5]=n=>a(t).stakeAmountUnlimited=n),class:"col-md-6"},{default:c(()=>[w("Unlimited stake")]),_:1},8,["modelValue"]),s(f,{id:"stake-amount",modelValue:a(t).stakeAmount,"onUpdate:modelValue":l[6]||(l[6]=n=>a(t).stakeAmount=n),type:"number",placeholder:"Use strategy default",step:"0.01",disabled:a(t).stakeAmountUnlimited},null,8,["modelValue","disabled"])])]),_:1}),s(o,{"label-cols-sm":"5",label:"Enable Protections:","label-align-sm":"right","label-for":"enable-protections"},{default:c(()=>[s(k,{id:"enable-protections",modelValue:a(t).enableProtections,"onUpdate:modelValue":l[7]||(l[7]=n=>a(t).enableProtections=n)},null,8,["modelValue"])]),_:1}),a(e).activeBot.botApiVersion>=2.22?(u(),R(o,{key:0,"label-cols-sm":"5",label:"Cache Backtest results:","label-align-sm":"right","label-for":"enable-cache"},{default:c(()=>[s(k,{id:"enable-cache",modelValue:a(t).allowCache,"onUpdate:modelValue":l[8]||(l[8]=n=>a(t).allowCache=n)},null,8,["modelValue"])]),_:1})):p("",!0),a(e).activeBot.botApiVersion>=2.22?(u(),v(S,{key:1},[s(o,{"label-cols-sm":"5",label:"Enable FreqAI:","label-align-sm":"right","label-for":"enable-freqai"},{label:c(()=>[d("div",Bt,[wt,s(ae,{hint:"Assumes freqAI configuration is setup in the configuration, and the strategy is a freqAI strategy. Will fail if that's not the case."})])]),default:c(()=>[s(k,{id:"enable-freqai",modelValue:a(t).freqAI.enabled,"onUpdate:modelValue":l[9]||(l[9]=n=>a(t).freqAI.enabled=n)},null,8,["modelValue"])]),_:1}),a(t).freqAI.enabled?(u(),R(o,{key:0,"label-cols-sm":"5",label:"FreqAI identifier:","label-align-sm":"right","label-for":"freqai-identifier"},{default:c(()=>[s(f,{id:"freqai-identifier",modelValue:a(t).freqAI.identifier,"onUpdate:modelValue":l[10]||(l[10]=n=>a(t).freqAI.identifier=n),placeholder:"Use config default"},null,8,["modelValue"])]),_:1})):p("",!0),a(t).freqAI.enabled?(u(),R(o,{key:1,"label-cols-sm":"5",label:"FreqAI Model","label-align-sm":"right","label-for":"freqai-model"},{default:c(()=>[s(yt,{id:"freqai-model",modelValue:a(t).freqAI.model,"onUpdate:modelValue":l[11]||(l[11]=n=>a(t).freqAI.model=n)},null,8,["modelValue"])]),_:1})):p("",!0)],64)):p("",!0),$t,s(Te,{modelValue:a(t).timerange,"onUpdate:modelValue":l[12]||(l[12]=n=>a(t).timerange=n),class:"mt-2"},null,8,["modelValue"])]),_:1})]),_:1},8,["disabled"]),Vt,d("div",Ct,[s(_,{id:"start-backtest",variant:"primary",disabled:a(e).activeBot.backtestRunning||!a(e).activeBot.canRunBacktest,class:"mx-1",onClick:b},{default:c(()=>[w(" Start backtest ")]),_:1},8,["disabled"]),s(_,{variant:"primary",disabled:a(e).activeBot.backtestRunning||!a(e).activeBot.canRunBacktest,class:"mx-1",onClick:a(e).activeBot.pollBacktest},{default:c(()=>[w(" Load backtest result ")]),_:1},8,["disabled","onClick"]),s(_,{variant:"primary",class:"mx-1",disabled:!a(e).activeBot.backtestRunning,onClick:a(e).activeBot.stopBacktest},{default:c(()=>[w("Stop Backtest")]),_:1},8,["disabled","onClick"]),s(_,{variant:"primary",class:"mx-1",disabled:a(e).activeBot.backtestRunning||!a(e).activeBot.canRunBacktest,onClick:a(e).activeBot.removeBacktest},{default:c(()=>[w("Reset Backtest")]),_:1},8,["disabled","onClick"])])],64)}}}),St=i=>(Z("data-v-41e6328c"),i=i(),X(),i),Tt={class:"d-flex flex-column pt-1 me-1",style:{height:"calc(100vh - 60px)"}},qt={class:"d-flex flex-row"},Ut=St(()=>d("h2",{class:"ms-5"},"Backtesting",-1)),Pt={key:0},It={class:"w-100"},Mt={class:"mx-md-5 d-flex flex-wrap justify-content-md-center justify-content-between mb-4 gap-2"},Dt={class:"d-flex flex-md-row"},Nt={class:"d-flex flex-column flex-fill mw-100"},Lt={class:"d-md-flex"},zt={key:0,class:"flex-fill d-flex flex-column bt-config"},Ft={key:1,class:"flex-fill d-flex flex-column bt-config"},jt={key:0,class:"container-fluid text-center w-100 mt-2"},Et=T({__name:"BacktestingView",setup(i){const e=D(),t=le(),b=$(()=>e.activeBot.backtestHistory?Object.keys(e.activeBot.backtestHistory).length!==0:!1),m=$(()=>{try{return e.activeBot.selectedBacktestResult.timeframe}catch{return""}}),l=A(!1),o=A("run"),f=A(null),k=()=>{t.strategy=e.activeBot.selectedBacktestResult.strategy_name,e.activeBot.getStrategy(t.strategy),t.selectedTimeframe=e.activeBot.selectedBacktestResult.timeframe,t.selectedDetailTimeframe=e.activeBot.selectedBacktestResult.timeframe_detail||"",t.timerange=e.activeBot.selectedBacktestResult.timerange};return H(()=>e.activeBot.selectedBacktestResultKey,()=>{k()}),O(()=>e.activeBot.getState()),H(()=>e.activeBot.backtestRunning,()=>{e.activeBot.backtestRunning===!0?f.value=window.setInterval(e.activeBot.pollBacktest,1e3):f.value&&(clearInterval(f.value),f.value=null)}),(h,_)=>{const n=ge,q=U;return u(),v("div",Tt,[d("div",null,[d("div",qt,[Ut,a(e).activeBot.canRunBacktest?p("",!0):(u(),v("p",Pt," Bot must be in webserver mode to enable Backtesting. ")),d("div",It,[d("div",Mt,[a(e).activeBot.botApiVersion>=2.15?(u(),R(n,{key:0,modelValue:o.value,"onUpdate:modelValue":_[0]||(_[0]=r=>o.value=r),name:"bt-form-radios",button:"",class:"mx-1 flex-samesize-items",value:"historicResults",disabled:!a(e).activeBot.canRunBacktest},{default:c(()=>[w("Load Results")]),_:1},8,["modelValue","disabled"])):p("",!0),s(n,{modelValue:o.value,"onUpdate:modelValue":_[1]||(_[1]=r=>o.value=r),name:"bt-form-radios",button:"",class:"mx-1 flex-samesize-items",value:"run",disabled:!a(e).activeBot.canRunBacktest},{default:c(()=>[w("Run backtest")]),_:1},8,["modelValue","disabled"]),s(n,{id:"bt-analyze-btn",modelValue:o.value,"onUpdate:modelValue":_[2]||(_[2]=r=>o.value=r),name:"bt-form-radios",button:"",class:"mx-1 flex-samesize-items",value:"results",disabled:!b.value},{default:c(()=>[w("Analyze result")]),_:1},8,["modelValue","disabled"]),s(n,{modelValue:o.value,"onUpdate:modelValue":_[3]||(_[3]=r=>o.value=r),name:"bt-form-radios",button:"",class:"mx-1 flex-samesize-items",value:"visualize-summary",disabled:!b.value},{default:c(()=>[w("Visualize summary")]),_:1},8,["modelValue","disabled"]),s(n,{modelValue:o.value,"onUpdate:modelValue":_[4]||(_[4]=r=>o.value=r),name:"bt-form-radios",button:"",class:"mx-1 flex-samesize-items",value:"visualize",disabled:!b.value},{default:c(()=>[w("Visualize result")]),_:1},8,["modelValue","disabled"])]),pe(d("small",{class:"text-end bt-running-label"},"Backtest running: "+x(a(e).activeBot.backtestStep)+" "+x(a(y)(a(e).activeBot.backtestProgress,2)),513),[[ke,a(e).activeBot.backtestRunning]])])])]),d("div",Dt,[o.value!=="visualize"?(u(),v("div",{key:0,class:W([`${l.value?"col-md-3":""}`,"sticky-top sticky-offset me-3 d-flex flex-column absolute"]),style:{"max-height":"calc(100vh - 60px)"}},[s(q,{class:"align-self-start","aria-label":"Close",size:"sm",onClick:_[5]||(_[5]=r=>l.value=!l.value)},{default:c(()=>[w(x(l.value?"<":">"),1)]),_:1}),s(ve,{name:"fade",mode:"in-out"},{default:c(()=>[o.value!=="visualize"&&l.value?(u(),R(ct,{key:0,"backtest-history":a(e).activeBot.backtestHistory,"selected-backtest-result-key":a(e).activeBot.selectedBacktestResultKey,"can-use-modify":a(e).activeBot.botApiVersion>=2.32,onSelectionChange:a(e).activeBot.setBacktestResultKey,onRemoveResult:a(e).activeBot.removeBacktestResultFromMemory,onUpdateResult:a(e).activeBot.saveBacktestResultMetadata},null,8,["backtest-history","selected-backtest-result-key","can-use-modify","onSelectionChange","onRemoveResult","onUpdateResult"])):p("",!0)]),_:1})],2)):p("",!0),d("div",Nt,[d("div",Lt,[o.value=="historicResults"?(u(),v("div",zt,[s(Ne)])):p("",!0),o.value=="run"?(u(),v("div",Ft,[s(At)])):p("",!0),b.value&&o.value=="results"?(u(),R(kt,{key:2,"backtest-result":a(e).activeBot.selectedBacktestResult,class:"flex-fill"},null,8,["backtest-result"])):p("",!0),b.value&&o.value=="visualize-summary"?(u(),R(Me,{key:3,trades:a(e).activeBot.selectedBacktestResult.trades,class:"flex-fill"},null,8,["trades"])):p("",!0)]),b.value&&o.value=="visualize"?(u(),v("div",jt,[s(tt,{timeframe:m.value,strategy:a(t).strategy,timerange:a(t).timerange,pairlist:a(e).activeBot.selectedBacktestResult.pairlist,trades:a(e).activeBot.selectedBacktestResult.trades,"freqai-model":a(t).freqAI.enabled?a(t).freqAI.model:void 0},null,8,["timeframe","strategy","timerange","pairlist","trades","freqai-model"])])):p("",!0)])])])}}});const sa=j(Et,[["__scopeId","data-v-41e6328c"]]);export{sa as default};
//# sourceMappingURL=BacktestingView-ec2f447f.js.map
