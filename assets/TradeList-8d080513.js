import{o as m,c as B,a as T,d as P,i as C,w as s,b as n,f as k,k as w,B as q,b0 as N,D as ie,r as b,b1 as de,u as j,h as K,v as V,l as z,m as se,U as G,G as Z,a5 as ue,R as W,b2 as ce,z as me,y as H,s as ve,Y as pe,j as A,x as fe,b3 as _e,g as be}from"./index-8c4b8b6b.js";import{b as xe,_ as U}from"./InfoBox.vue_vue_type_script_setup_true_lang-cf02f3fe.js";const ye={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},ge=T("path",{fill:"currentColor",d:"M4 20h14v2H4a2 2 0 0 1-2-2V6h2v14M20.22 2H7.78C6.8 2 6 2.8 6 3.78v12.44C6 17.2 6.8 18 7.78 18h12.44c.98 0 1.78-.8 1.78-1.78V3.78C22 2.8 21.2 2 20.22 2M19 13.6L17.6 15L14 11.4L10.4 15L9 13.6l3.6-3.6L9 6.4L10.4 5L14 8.6L17.6 5L19 6.4L15.4 10l3.6 3.6Z"},null,-1),$e=[ge];function ke(a,o){return m(),B("svg",ye,$e)}const Te={name:"mdi-close-box-multiple",render:ke},Ve={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},he=T("path",{fill:"currentColor",d:"M10 9a1 1 0 0 1 1-1a1 1 0 0 1 1 1v4.47l1.21.13l4.94 2.19c.53.24.85.77.85 1.35v4.36c-.03.82-.68 1.47-1.5 1.5H11c-.38 0-.74-.15-1-.43l-4.9-4.2l.74-.77c.19-.21.46-.32.74-.32h.22L10 19V9m1-4a4 4 0 0 1 4 4c0 1.5-.8 2.77-2 3.46v-1.22c.61-.55 1-1.35 1-2.24a3 3 0 0 0-3-3a3 3 0 0 0-3 3c0 .89.39 1.69 1 2.24v1.22C7.8 11.77 7 10.5 7 9a4 4 0 0 1 4-4Z"},null,-1),Ce=[he];function we(a,o){return m(),B("svg",Ve,Ce)}const Be={name:"mdi-gesture-tap",render:we},Oe={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},Ee=T("path",{fill:"currentColor",d:"M2 12c0 5 4 9 9 9c2.4 0 4.7-.9 6.4-2.6l-1.5-1.5c-1.3 1.4-3 2.1-4.9 2.1c-6.2 0-9.4-7.5-4.9-11.9S18 5.8 18 12h-3l4 4h.1l3.9-4h-3c0-5-4-9-9-9s-9 4-9 9m8 3h2v2h-2v-2m0-8h2v6h-2V7"},null,-1),Le=[Ee];function Fe(a,o){return m(),B("svg",Oe,Le)}const Se={name:"mdi-reload-alert",render:Fe},Ie={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},Ae=T("path",{fill:"currentColor",d:"M19 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V5a2 2 0 0 0-2-2m-3.4 14L12 13.4L8.4 17L7 15.6l3.6-3.6L7 8.4L8.4 7l3.6 3.6L15.6 7L17 8.4L13.4 12l3.6 3.6l-1.4 1.4Z"},null,-1),Pe=[Ae];function Re(a,o){return m(),B("svg",Ie,Pe)}const De={name:"mdi-close-box",render:Re},He={class:"d-flex flex-column"},Me=P({__name:"TradeActions",props:{botApiVersion:{type:Number,default:1},trade:{type:Object,required:!0}},emits:["forceExit","forceExitPartial","cancelOpenOrder","reloadTrade","deleteTrade"],setup(a){return(o,e)=>{const y=De,v=q,p=Te,f=N,r=Se,u=ie;return m(),B("div",He,[a.botApiVersion<=1.1?(m(),C(v,{key:0,class:"btn-xs text-start",size:"sm",title:"Forceexit",onClick:e[0]||(e[0]=_=>o.$emit("forceExit",a.trade))},{default:s(()=>[n(y,{class:"me-1"}),k("Forceexit ")]),_:1})):w("",!0),a.botApiVersion>1.1?(m(),C(v,{key:1,class:"btn-xs text-start",size:"sm",title:"Forceexit limit",onClick:e[1]||(e[1]=_=>o.$emit("forceExit",a.trade,"limit"))},{default:s(()=>[n(y,{class:"me-1"}),k("Forceexit limit ")]),_:1})):w("",!0),a.botApiVersion>1.1?(m(),C(v,{key:2,class:"btn-xs text-start mt-1",size:"sm",title:"Forceexit market",onClick:e[2]||(e[2]=_=>o.$emit("forceExit",a.trade,"market"))},{default:s(()=>[n(y,{class:"me-1"}),k("Forceexit market ")]),_:1})):w("",!0),a.botApiVersion>2.16?(m(),C(v,{key:3,class:"btn-xs text-start mt-1",size:"sm",title:"Forceexit partial",onClick:e[3]||(e[3]=_=>o.$emit("forceExitPartial",a.trade))},{default:s(()=>[n(p,{class:"me-1"}),k("Forceexit partial ")]),_:1})):w("",!0),a.botApiVersion>=2.24&&(a.trade.open_order_id||a.trade.has_open_orders)?(m(),C(v,{key:4,class:"btn-xs text-start mt-1",size:"sm",title:"Cancel open orders",onClick:e[4]||(e[4]=_=>o.$emit("cancelOpenOrder",a.trade))},{default:s(()=>[n(f,{class:"me-1"}),k("Cancel open order ")]),_:1})):w("",!0),a.botApiVersion>=2.28?(m(),C(v,{key:5,class:"btn-xs text-start mt-1",size:"sm",title:"Reload",onClick:e[5]||(e[5]=_=>o.$emit("reloadTrade",a.trade))},{default:s(()=>[n(r,{class:"me-1"}),k("Reload Trade ")]),_:1})):w("",!0),n(v,{class:"btn-xs text-start mt-1",size:"sm",title:"Delete trade",onClick:e[6]||(e[6]=_=>o.$emit("deleteTrade",a.trade))},{default:s(()=>[n(u,{class:"me-1"}),k(" Delete ")]),_:1})])}}}),ze=P({__name:"TradeActionsPopover",props:{trade:{type:Object,required:!0},id:{type:Number,required:!0},botApiVersion:{type:Number,required:!0}},emits:["forceExit","forceExitPartial","cancelOpenOrder","reloadTrade","deleteTrade"],setup(a,{emit:o}){const e=b(!1);function y(r,u=void 0){e.value=!1,o("forceExit",r,u)}function v(r){e.value=!1,o("forceExitPartial",r)}function p(r){e.value=!1,o("cancelOpenOrder",r)}function f(r){e.value=!1,o("reloadTrade",r)}return(r,u)=>{const _=Be,h=q,x=N,c=de;return m(),B("div",null,[n(h,{id:`btn-actions-${a.id}`,class:"btn-xs",size:"sm",title:"Actions",onClick:u[0]||(u[0]=i=>e.value=!e.value)},{default:s(()=>[n(_)]),_:1},8,["id"]),n(c,{target:`btn-actions-${a.id}`,title:`Actions for ${a.trade.pair}`,triggers:"manual",show:e.value,placement:"left"},{default:s(()=>[n(Me,{trade:a.trade,"bot-api-version":a.botApiVersion,onForceExit:y,onForceExitPartial:v,onDeleteTrade:u[1]||(u[1]=i=>{e.value=!1,r.$emit("deleteTrade",a.trade)}),onCancelOpenOrder:p,onReloadTrade:f},null,8,["trade","bot-api-version"]),n(h,{class:"mt-1 w-100 text-start",size:"sm",onClick:u[2]||(u[2]=i=>e.value=!1)},{default:s(()=>[n(x,{class:"me-1"}),k("Close Actions menu ")]),_:1})]),_:1},8,["target","title","show"])])}}}),Ue=["onSubmit"],qe=T("br",null,null,-1),Ne=P({__name:"ForceExitForm",props:{trade:{type:Object,required:!0},modelValue:{required:!0,default:!1,type:Boolean}},emits:["update:modelValue"],setup(a,{emit:o}){const e=a,y=j(),v=b(),p=b(void 0),f=b("limit"),r=()=>{var i;return(i=v.value)==null?void 0:i.checkValidity()},u=K({get(){return e.modelValue},set(c){o("update:modelValue",c)}}),_=()=>{if(!r())return;const c={tradeid:String(e.trade.trade_id)};f.value&&(c.ordertype=f.value),p.value&&(c.amount=p.value),y.activeBot.forceexit(c),u.value=!1},h=()=>{var c,i,O,E;p.value=e.trade.amount,f.value=((i=(c=y.activeBot.botState)==null?void 0:c.order_types)==null?void 0:i.force_exit)||((E=(O=y.activeBot.botState)==null?void 0:O.order_types)==null?void 0:E.exit)||"limit"},x=()=>{_()};return(c,i)=>{const O=G,E=Z,S=ue,R=W;return m(),B("div",null,[n(R,{id:"forceexit-modal",modelValue:u.value,"onUpdate:modelValue":i[3]||(i[3]=g=>u.value=g),title:"Force exiting a trade",onShow:h,onHidden:h,onOk:x},{default:s(()=>[T("form",{ref_key:"form",ref:v,onSubmit:se(_,["stop","prevent"])},[T("p",null,[T("span",null,"Exiting Trade #"+V(a.trade.trade_id)+" "+V(a.trade.pair)+".",1),qe,T("span",null,"Currently owning "+V(a.trade.amount)+" "+V(a.trade.base_currency),1)]),n(E,{label:`*Amount in ${a.trade.base_currency} [optional]`,"label-for":"stake-input","invalid-feedback":"Amount must be empty or a positive number",state:p.value!==void 0&&p.value>0},{default:s(()=>[n(O,{id:"stake-input",modelValue:p.value,"onUpdate:modelValue":i[0]||(i[0]=g=>p.value=g),type:"number",step:"0.000001",onKeydown:z(x,["enter"])},null,8,["modelValue","onKeydown"]),n(O,{id:"stake-input",modelValue:p.value,"onUpdate:modelValue":i[1]||(i[1]=g=>p.value=g),type:"range",step:"0.000001",min:"0",max:a.trade.amount,onKeydown:z(x,["enter"])},null,8,["modelValue","max","onKeydown"])]),_:1},8,["label","state"]),n(E,{label:"*OrderType","label-for":"ordertype-input","invalid-feedback":"OrderType",state:f.value!==void 0},{default:s(()=>[n(S,{modelValue:f.value,"onUpdate:modelValue":i[2]||(i[2]=g=>f.value=g),class:"ms-2",options:["market","limit"],style:{"min-width":"7em"},size:"sm"},null,8,["modelValue"])]),_:1},8,["state"])],40,Ue)]),_:1},8,["modelValue"])])}}}),je={class:"h-100 overflow-auto w-100"},Ke={class:"w-100 d-flex justify-content-between"},Ge=P({__name:"TradeList",props:{trades:{required:!0,type:Array},title:{default:"Trades",type:String},stakeCurrency:{required:!1,default:"",type:String},activeTrades:{default:!1,type:Boolean},showFilter:{default:!1,type:Boolean},multiBotView:{default:!1,type:Boolean},emptyText:{default:"No Trades to show.",type:String}},setup(a){const o=a,e=j(),y=ce(),v=b(1),p=b(),f=b(""),r=b({}),u=o.activeTrades?200:15,_=b(),h=b(!1),x=b(!1),c=b(""),i=b(null),O=[{key:"actions"}],E=[{key:"close_timestamp",label:"Close date"},{key:"exit_reason",label:"Close Reason"}],S=t=>H(t,e.activeBot.stakeCurrencyDecimals),R=K(()=>o.trades.length),g=b([]);me(()=>{g.value=[{key:"trade_id",label:"ID"},{key:"pair",label:"Pair"},{key:"amount",label:"Amount"},{key:"stake_amount",label:"Stake amount"},{key:"open_rate",label:"Open rate",formatter:t=>H(t)},{key:o.activeTrades?"current_rate":"close_rate",label:o.activeTrades?"Current rate":"Close rate",formatter:t=>H(t)},{key:"profit",label:o.activeTrades?"Current profit %":"Profit %",formatter:(t,d,$)=>{if(!$)return"";const L=$;return`${ve(L.profit_ratio,2)} ${`(${S(L.profit_abs)})`}`}},{key:"open_timestamp",label:"Open date"},...o.activeTrades?O:E],o.multiBotView&&g.value.unshift({key:"botName",label:"Bot"})});const I=b(void 0),Y=(t,d=void 0)=>{r.value=t,i.value=1,c.value=`Really exit trade ${t.trade_id} (Pair ${t.pair}) using ${d} Order?`,x.value=!0,I.value=d},J=()=>{if(i.value===0){const t={tradeid:String(r.value.trade_id),botId:r.value.botId};e.deleteTradeMulti(t).catch(d=>console.log(d.response))}if(i.value===1){const t={tradeid:String(r.value.trade_id),botId:r.value.botId};I.value&&(t.ordertype=I.value),e.forceSellMulti(t).then(d=>console.log(d)).catch(d=>console.log(d.response))}if(i.value===3){const t={tradeid:String(r.value.trade_id),botId:r.value.botId};e.cancelOpenOrderMulti(t)}I.value=void 0,x.value=!1},Q=t=>{c.value=`Really delete trade ${t.trade_id} (Pair ${t.pair})?`,i.value=0,r.value=t,x.value=!0},X=t=>{r.value=t,h.value=!0},ee=t=>{c.value=`Cancel open order for trade ${t.trade_id} (Pair ${t.pair})?`,r.value=t,i.value=3,x.value=!0};function te(t){e.reloadTradeMulti({tradeid:String(t.trade_id),botId:t.botId})}const ae=(t,d,$)=>{o.activeTrades&&($.preventDefault(),console.log(t))},oe=t=>{o.multiBotView&&e.selectedBot!==t.botId&&e.selectBot(t.botId),t&&t.trade_id!==e.activeBot.detailTradeId?(e.activeBot.setDetailTrade(t),o.multiBotView&&y.push({name:"Freqtrade Trading"})):e.activeBot.setDetailTrade(null)},le=()=>{var t;if(e.activeBot.detailTradeId){const d=o.trades.findIndex($=>$.trade_id===e.activeBot.detailTradeId);d>=0?(t=_.value)==null||t.selectRow(d):(console.log(`Unsetting item for tradeid ${p.value}`),p.value=void 0)}};return pe(()=>e.activeBot.detailTradeId,t=>{var $;o.trades.findIndex(L=>L.trade_id===t)<0&&(($=_.value)==null||$.clearSelected())}),(t,d)=>{const $=fe,L=_e,M=G,ne=Z,re=W;return m(),B("div",je,[n($,{ref_key:"tradesTable",ref:_,small:"",hover:"",stacked:"md",items:a.trades.filter(l=>{var F,D;return l.pair.toLowerCase().includes(f.value.toLowerCase())||((F=l.exit_reason)==null?void 0:F.toLowerCase().includes(f.value.toLowerCase()))||((D=l.enter_tag)==null?void 0:D.toLowerCase().includes(f.value.toLowerCase()))}),fields:g.value,"show-empty":"","empty-text":a.emptyText,"per-page":A(u),"current-page":v.value,"primary-key":"botTradeId",selectable:"","select-head":!1,"select-mode":"single",onRowContextmenu:ae,onRowClicked:oe,onRowSelected:le},{"cell(actions)":s(({index:l,item:F})=>[n(ze,{id:l,trade:F,"bot-api-version":A(e).activeBot.botApiVersion,onDeleteTrade:D=>Q(F),onForceExit:Y,onForceExitPartial:X,onCancelOpenOrder:ee,onReloadTrade:te},null,8,["id","trade","bot-api-version","onDeleteTrade"])]),"cell(pair)":s(l=>[T("span",null,V(`${l.item.pair}${l.item.open_order_id||l.item.has_open_orders?"*":""}`),1)]),"cell(trade_id)":s(l=>[k(V(l.item.trade_id)+" "+V(A(e).activeBot.botApiVersion>2&&l.item.trading_mode!=="spot"?"| "+(l.item.is_short?"Short":"Long"):""),1)]),"cell(stake_amount)":s(l=>[k(V(S(l.item.stake_amount))+" "+V(l.item.trading_mode!=="spot"?`(${l.item.leverage}x)`:""),1)]),"cell(profit)":s(l=>[n(xe,{trade:l.item},null,8,["trade"])]),"cell(open_timestamp)":s(l=>[n(U,{date:l.item.open_timestamp},null,8,["date"])]),"cell(close_timestamp)":s(l=>[n(U,{date:l.item.close_timestamp??0},null,8,["date"])]),_:1},8,["items","fields","empty-text","per-page","current-page"]),T("div",Ke,[a.activeTrades?w("",!0):(m(),C(L,{key:0,modelValue:v.value,"onUpdate:modelValue":d[0]||(d[0]=l=>v.value=l),"total-rows":R.value,"per-page":A(u),"aria-controls":"my-table"},null,8,["modelValue","total-rows","per-page"])),a.showFilter?(m(),C(ne,{key:1,"label-for":"trade-filter"},{default:s(()=>[n(M,{id:"trade-filter",modelValue:f.value,"onUpdate:modelValue":d[1]||(d[1]=l=>f.value=l),type:"text",placeholder:"Filter"},null,8,["modelValue"])]),_:1})):w("",!0)]),a.activeTrades?(m(),C(Ne,{key:0,modelValue:h.value,"onUpdate:modelValue":d[2]||(d[2]=l=>h.value=l),trade:r.value},null,8,["modelValue","trade"])):w("",!0),n(re,{modelValue:x.value,"onUpdate:modelValue":d[3]||(d[3]=l=>x.value=l),title:"Exit trade",onOk:J},{default:s(()=>[k(V(c.value),1)]),_:1},8,["modelValue"])])}}});const Ye=be(Ge,[["__scopeId","data-v-8b39fa39"]]);export{Ye as T,Te as _};
//# sourceMappingURL=TradeList-8d080513.js.map
